<!DOCTYPE html>
<html lang="vi">
	<head>
		<meta charset="UTF-8" />
		<title>Lofi Music</title>
		<!-- Thêm Tailwind CSS -->
		<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
	</head>
	<body class="bg-gray-800 text-white font-sans text-center p-5">
		<h1 class="text-3xl font-bold mb-6 flex items-center justify-center space-x-3 text-gray-100">
			<span>🎧</span>
			<span>Trình Nghe Nhạc</span>
		</h1>

		<div class="mb-5">
			<button onclick="playNext()" class="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition">Tiếp theo</button>
			<button onclick="toggleRandom()" class="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition">Chế độ: <span id="mode">Ngẫu nhiên</span></button>
		</div>

		<!-- Player: Container chứ không dùng video cố định -->
		<div id="playerContainer" class="w-full max-w-lg mx-auto rounded-lg bg-black overflow-hidden"></div>

		<div id="currentSong" class="mt-4 flex items-center justify-center space-x-3 text-lg bg-gray-700 p-3 rounded-xl shadow-lg max-w-md mx-auto"></div>

		<!-- Danh sách bài hát -->
		<ul id="playlist" class="mt-6 max-w-lg mx-auto bg-gray-700 rounded-lg shadow divide-y divide-gray-600 text-left"></ul>

		<script>
			const musicList = [
				"music/1.mp4",
				"music/2.mp4",
				"music/3.mp4",
				"music/4.mp4",
				"music/5.mp4",
				"music/6.mp4",
				"music/7.mp4",
				"music/8.mp3",
				"music/9.mp4",
				"music/10.mp3",
				"music/11.mp3",
				"music/12.mp3",
				"music/13.mp3",
				"music/14.mp3",
				"music/15.mp3",
				"music/16.mp3",
				"music/17.mp3",
				"music/18.mp3",
				"music/19.mp3",
				"music/20.mp3",
				"music/21.mp3",
				"music/22.mp3",
				"music/24.mp3",
				"music/25.mp3",
				"music/26.mp3",
				"music/27.mp3",
				"music/28.mp3",
				"music/29.mp3",
				// Thêm link YouTube ví dụ:
				"https://www.youtube.com/embed/lqFGzPM8wkg",
				"https://www.youtube.com/embed/xi1cWsfJTTs",
			];

			const songNames = [
				"Tháp Rơi Tự Do",
				"Ghép Hình Tình Yêu",
				"Góp Vui",
				"Kiss Kiss Shy Shy",
				"Như",
				"Bất Công",
				"CocoCoCo",
				"Magnetic",
				"Sơn Hải",
				"Nhập Hoài",
				"Không Nỡ - Đấu La Đại Lục",
				"Có - Không Có",
				"Đối Diện",
				"Tham Cầu - Thần Ẩn",
				"Ring Ring Ring",
				"TA - Bàn Hổ",
				"Như Ca - Liệt Hỏa Như Ca",
				"Cái Đuôi Nhỏ",
				"Lưu Chuyển Doanh Hồi",
				"Đông Miên",
				"Polaroid Love",
				"For ya – Tưởng Tiểu Ni",
				"Say YES",
				"Chờ Đến Tháng 13",
				"Mình Cùng Nhau Đóng Băng",
				"Trang Giấy Cuối Cùng",
				"Blueming - IU",
				"Yêu Như Thế - Thần Ẩn",
				// Tên bài cho YouTube link
				"Học bài và nghe nhạc cùng tớ nhé",
				"Dữ Phượng Hành OST",
			];

			let currentIndex = 0;
			let isRandom = true;

			const playerContainer = document.getElementById("playerContainer");
			const modeSpan = document.getElementById("mode");
			const currentSongDisplay = document.getElementById("currentSong");
			const playlist = document.getElementById("playlist");

			function renderPlaylist() {
				playlist.innerHTML = "";
				songNames.forEach((name, idx) => {
					const li = document.createElement("li");
					const isYouTube = musicList[idx].includes("youtube.com") || musicList[idx].includes("youtu.be");
					const url = musicList[idx];
					let icon = "🎵"; // Mặc định

					if (url.includes("youtube.com") || url.includes("youtu.be")) {
						icon = "▶️"; // YouTube
					} else if (url.endsWith(".mp3")) {
						icon = "🎶"; // Audio mp3
					} else if (url.endsWith(".mp4")) {
						icon = "🎬"; // Video mp4
					}

					li.textContent = `${icon} ${name}`;
					li.className = "cursor-pointer px-4 py-2 hover:bg-gray-600 transition" + (idx === currentIndex ? " bg-gray-500 font-bold" : "");
					li.onclick = () => {
						currentIndex = idx;
						play(currentIndex);
						renderPlaylist();
					};
					playlist.appendChild(li);
				});
			}

			function play(index) {
				const url = musicList[index];
				playerContainer.innerHTML = ""; // Xóa nội dung player cũ

				if (url.includes("youtube.com") || url.includes("youtu.be")) {
					// Link YouTube
					const iframe = document.createElement("iframe");
					iframe.src = url + "?autoplay=1"; // Auto-play YouTube
					iframe.width = "100%";
					iframe.height = "315";
					iframe.frameBorder = "0";
					iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
					iframe.allowFullscreen = true;
					playerContainer.appendChild(iframe);
				} else {
					// File mp3/mp4
					const video = document.createElement("video");
					video.src = url;
					video.controls = true;
					video.playsInline = true;
					video.autoplay = true;
					video.className = "w-full";
					video.volume = 0.5;
					video.addEventListener("ended", playNext);
					playerContainer.appendChild(video);
				}

				// Xác định icon theo loại file
				let icon = "🎵";
				if (url.includes("youtube.com") || url.includes("youtu.be")) {
					icon = "▶️";
				} else if (url.endsWith(".mp3")) {
					icon = "🎶";
				} else if (url.endsWith(".mp4")) {
					icon = "🎬";
				}

				// Cập nhật nội dung "Đang phát"
				currentSongDisplay.innerHTML = `<span class="text-2xl">${icon}</span> <span>${songNames[index]}</span>`;

				renderPlaylist();
			}

			function playNext() {
				if (isRandom) {
					let nextIndex;
					const nonYoutubeIndexes = musicList.map((item, idx) => (!item.includes("youtube.com") && !item.includes("youtu.be") ? idx : -1)).filter((idx) => idx !== -1);

					do {
						const randomPos = Math.floor(Math.random() * nonYoutubeIndexes.length);
						nextIndex = nonYoutubeIndexes[randomPos];
					} while (nonYoutubeIndexes.length > 1 && nextIndex === currentIndex);

					currentIndex = nextIndex;
				} else {
					currentIndex = (currentIndex + 1) % musicList.length;
				}
				play(currentIndex);
			}

			function toggleRandom() {
				isRandom = !isRandom;
				modeSpan.textContent = isRandom ? "Ngẫu nhiên" : "Tuần tự";
			}

			// Khởi động trang
			modeSpan.textContent = isRandom ? "Ngẫu nhiên" : "Tuần tự";
			renderPlaylist();
		</script>
	</body>
</html>
