<!DOCTYPE html>
<html lang="vi">
	<head>
		<meta charset="UTF-8" />
		<title>Lofi Music</title>
		<!-- Th√™m Tailwind CSS -->
		<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
	</head>
	<body class="bg-gray-800 text-white font-sans text-center p-5">
		<h1 class="text-3xl font-bold mb-6 flex items-center justify-center space-x-3 text-gray-100">
			<span>üéß</span>
			<span>Tr√¨nh Nghe Nh·∫°c</span>
		</h1>

		<div class="mb-5">
			<button onclick="playNext()" class="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition">Ti·∫øp theo</button>
			<button onclick="toggleRandom()" class="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition">Ch·∫ø ƒë·ªô: <span id="mode">Ng·∫´u nhi√™n</span></button>
		</div>

		<!-- Player: Container ch·ª© kh√¥ng d√πng video c·ªë ƒë·ªãnh -->
		<div id="playerContainer" class="w-full max-w-lg mx-auto rounded-lg bg-black overflow-hidden"></div>

		<div id="currentSong" class="mt-4 flex items-center justify-center space-x-3 text-lg bg-gray-700 p-3 rounded-xl shadow-lg max-w-md mx-auto"></div>

		<!-- Danh s√°ch b√†i h√°t -->
		<ul id="playlist" class="mt-6 max-w-lg mx-auto bg-gray-700 rounded-lg shadow divide-y divide-gray-600 text-left"></ul>
		<div id="pagination" class="flex justify-center items-center space-x-2 mt-4"></div>

		<script>
			const musicList = [
				"music/1.mp4",
				"music/2.mp4",
				"music/3.mp4",
				"music/4.mp4",
				"music/5.mp4",
				"music/6.mp4",
				"music/7.mp4",
				"music/8.mp3",
				"music/9.mp4",
				"music/10.mp3",
				"music/11.mp3",
				"music/12.mp3",
				"music/13.mp3",
				"music/14.mp3",
				"music/15.mp3",
				"music/16.mp3",
				"music/17.mp3",
				"music/18.mp3",
				"music/19.mp3",
				"music/20.mp3",
				"music/21.mp3",
				"music/22.mp3",
				"music/24.mp3",
				"music/25.mp3",
				"music/26.mp3",
				"music/27.mp3",
				"music/28.mp3",
				"music/29.mp3",
				// Th√™m link YouTube v√≠ d·ª•:
				"https://www.youtube.com/embed/lqFGzPM8wkg",
				"https://www.youtube.com/embed/xi1cWsfJTTs",
			];

			const songNames = [
				"Th√°p R∆°i T·ª± Do",
				"Gh√©p H√¨nh T√¨nh Y√™u",
				"G√≥p Vui",
				"Kiss Kiss Shy Shy",
				"Nh∆∞",
				"B·∫•t C√¥ng",
				"CocoCoCo",
				"Magnetic",
				"S∆°n H·∫£i",
				"Nh·∫≠p Ho√†i",
				"Kh√¥ng N·ª° - ƒê·∫•u La ƒê·∫°i L·ª•c",
				"C√≥ - Kh√¥ng C√≥",
				"ƒê·ªëi Di·ªán",
				"Tham C·∫ßu - Th·∫ßn ·∫®n",
				"Ring Ring Ring",
				"TA - B√†n H·ªï",
				"Nh∆∞ Ca - Li·ªát H·ªèa Nh∆∞ Ca",
				"C√°i ƒêu√¥i Nh·ªè",
				"L∆∞u Chuy·ªÉn Doanh H·ªìi",
				"ƒê√¥ng Mi√™n",
				"Polaroid Love",
				"For ya ‚Äì T∆∞·ªüng Ti·ªÉu Ni",
				"Say YES",
				"Ch·ªù ƒê·∫øn Th√°ng 13",
				"M√¨nh C√πng Nhau ƒê√≥ng BƒÉng",
				"Trang Gi·∫•y Cu·ªëi C√πng",
				"Blueming - IU",
				"Y√™u Nh∆∞ Th·∫ø - Th·∫ßn ·∫®n",
				// T√™n b√†i cho YouTube link
				"H·ªçc b√†i v√† nghe nh·∫°c c√πng t·ªõ nh√©",
				"D·ªØ Ph∆∞·ª£ng H√†nh OST",
			];

			let currentIndex = 0;
			let isRandom = true;
			let currentPage = 1;
			const pageSize = 10;

			const playerContainer = document.getElementById("playerContainer");
			const modeSpan = document.getElementById("mode");
			const currentSongDisplay = document.getElementById("currentSong");
			const playlist = document.getElementById("playlist");

			function renderPlaylist() {
				playlist.innerHTML = "";
				const start = (currentPage - 1) * pageSize;
				const end = Math.min(start + pageSize, songNames.length);

				for (let idx = start; idx < end; idx++) {
					const name = songNames[idx];
					const url = musicList[idx];
					let icon = "üéµ";
					if (url.includes("youtube.com") || url.includes("youtu.be")) {
						icon = "‚ñ∂Ô∏è";
					} else if (url.endsWith(".mp3")) {
						icon = "üé∂";
					} else if (url.endsWith(".mp4")) {
						icon = "üé¨";
					}

					const li = document.createElement("li");
					li.textContent = `${icon} ${name}`;
					li.className = "cursor-pointer px-4 py-2 hover:bg-gray-600 transition" + (idx === currentIndex ? " bg-gray-500 font-bold" : "");
					li.onclick = () => {
						currentIndex = idx;
						play(currentIndex);
						renderPlaylist();
					};
					playlist.appendChild(li);
				}

				renderPagination();
			}

			function renderPagination() {
				const pagination = document.getElementById("pagination");
				pagination.innerHTML = "";
				const totalPages = Math.ceil(songNames.length / pageSize);

				// N√∫t Prev
				const prevBtn = document.createElement("button");
				prevBtn.textContent = "¬´";
				prevBtn.disabled = currentPage === 1;
				prevBtn.className = "px-2 py-1 rounded bg-gray-600 hover:bg-gray-500 disabled:opacity-50";
				prevBtn.onclick = () => {
					if (currentPage > 1) {
						currentPage--;
						renderPlaylist();
					}
				};
				pagination.appendChild(prevBtn);

				// Hi·ªÉn th·ªã s·ªë trang
				for (let i = 1; i <= totalPages; i++) {
					const pageBtn = document.createElement("button");
					pageBtn.textContent = i;
					pageBtn.className = "px-2 py-1 rounded " + (i === currentPage ? "bg-blue-500 text-white" : "bg-gray-600 hover:bg-gray-500");
					pageBtn.onclick = () => {
						currentPage = i;
						renderPlaylist();
					};
					pagination.appendChild(pageBtn);
				}

				// N√∫t Next
				const nextBtn = document.createElement("button");
				nextBtn.textContent = "¬ª";
				nextBtn.disabled = currentPage === totalPages;
				nextBtn.className = "px-2 py-1 rounded bg-gray-600 hover:bg-gray-500 disabled:opacity-50";
				nextBtn.onclick = () => {
					if (currentPage < totalPages) {
						currentPage++;
						renderPlaylist();
					}
				};
				pagination.appendChild(nextBtn);
			}

			function play(index) {
				const url = musicList[index];
				// T·ª± ƒë·ªông chuy·ªÉn trang ch·ª©a b√†i h√°t ƒëang ph√°t
				currentPage = Math.floor(index / pageSize) + 1;

				playerContainer.innerHTML = ""; // X√≥a n·ªôi dung player c≈©

				if (url.includes("youtube.com") || url.includes("youtu.be")) {
					// Link YouTube
					const iframe = document.createElement("iframe");
					iframe.src = url + "?autoplay=1";
					iframe.width = "100%";
					iframe.height = "315";
					iframe.frameBorder = "0";
					iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
					iframe.allowFullscreen = true;
					playerContainer.appendChild(iframe);
				} else {
					// File mp3/mp4
					const video = document.createElement("video");
					video.src = url;
					video.controls = true;
					video.playsInline = true;
					video.autoplay = true;
					video.className = "w-full";
					video.volume = 0.5;
					video.addEventListener("ended", playNext);
					playerContainer.appendChild(video);
				}

				// X√°c ƒë·ªãnh icon theo lo·∫°i file
				let icon = "üéµ";
				if (url.includes("youtube.com") || url.includes("youtu.be")) {
					icon = "‚ñ∂Ô∏è";
				} else if (url.endsWith(".mp3")) {
					icon = "üé∂";
				} else if (url.endsWith(".mp4")) {
					icon = "üé¨";
				}

				// C·∫≠p nh·∫≠t n·ªôi dung "ƒêang ph√°t"
				currentSongDisplay.innerHTML = `<span class="text-2xl">${icon}</span> <span>${songNames[index]}</span>`;

				renderPlaylist();
			}

			function playNext() {
				if (isRandom) {
					let nextIndex;
					const nonYoutubeIndexes = musicList.map((item, idx) => (!item.includes("youtube.com") && !item.includes("youtu.be") ? idx : -1)).filter((idx) => idx !== -1);

					do {
						const randomPos = Math.floor(Math.random() * nonYoutubeIndexes.length);
						nextIndex = nonYoutubeIndexes[randomPos];
					} while (nonYoutubeIndexes.length > 1 && nextIndex === currentIndex);

					currentIndex = nextIndex;
				} else {
					currentIndex = (currentIndex + 1) % musicList.length;
				}
				play(currentIndex);
			}

			function toggleRandom() {
				isRandom = !isRandom;
				modeSpan.textContent = isRandom ? "Ng·∫´u nhi√™n" : "Tu·∫ßn t·ª±";
			}

			// Kh·ªüi ƒë·ªông trang
			modeSpan.textContent = isRandom ? "Ng·∫´u nhi√™n" : "Tu·∫ßn t·ª±";
			renderPlaylist();
			play(currentIndex);
		</script>
	</body>
</html>
